(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{5984:function(t,e,r){Promise.resolve().then(r.bind(r,7123))},9376:function(t,e,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(e,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(e,{useRouter:function(){return a.useRouter}})},7123:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return c}});var a=r(7437),n=r(5687),i=r(9376),s=r(2265),o=r(521);function c(t){let{children:e}=t,{isAuthenticated:r,isVerifying:c}=(0,n.a)(),u=(0,i.useRouter)();return((0,s.useEffect)(()=>{c||r||u.push("/")},[r,c,u]),c)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)(o.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-[var(--primary)] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[var(--text-secondary)]",children:"Проверка авторизации..."})]})}):r?(0,a.jsx)("div",{className:"min-h-screen pb-20",children:e}):null}},5687:function(t,e,r){"use strict";r.d(e,{a:function(){return o}});var a=r(2265),n=r(7798),i=r(4708);let s={isAuthenticated:!1,isVerifying:!1,txHash:null,txStatus:i.bH.IDLE,error:null,authToken:null};function o(){let[t,e]=(0,a.useState)(()=>{{let t=localStorage.getItem(i.I.AUTH_TOKEN),e=localStorage.getItem(i.I.AUTH_EXPIRY);if(t&&e&&new Date(e)>new Date)return{...s,isAuthenticated:!0,authToken:t}}return s}),r=(0,a.useCallback)(()=>{let t=localStorage.getItem(i.I.AUTH_TOKEN),e=localStorage.getItem(i.I.AUTH_EXPIRY);return!!t&&!!e&&new Date(e)>new Date},[]),o=(t,e)=>btoa(JSON.stringify({address:t,txHash:e,timestamp:Date.now()})),c=(0,a.useCallback)(async t=>{e(t=>({...t,isVerifying:!0,error:null,txStatus:i.bH.IDLE}));try{if(!await n.i.hasRequiredBalance(t))return e(t=>({...t,isVerifying:!1,error:i.sl.INSUFFICIENT_PLEX})),!1;e(t=>({...t,txStatus:i.bH.PENDING}));let r=await n.i.sendVerificationTransaction();if(e(t=>({...t,txHash:r})),!await n.i.verifyTransaction(r))return e(t=>({...t,isVerifying:!1,txStatus:i.bH.FAILED,error:i.sl.TRANSACTION_FAILED})),!1;let a=o(t,r),s=new Date;return s.setHours(s.getHours()+24),localStorage.setItem(i.I.AUTH_TOKEN,a),localStorage.setItem(i.I.AUTH_EXPIRY,s.toISOString()),e({isAuthenticated:!0,isVerifying:!1,txHash:r,txStatus:i.bH.SUCCESS,error:null,authToken:a}),!0}catch(r){let t="Ошибка авторизации";return 4001===r.code?t=i.sl.USER_REJECTED:r.message&&(t=r.message),e(e=>({...e,isVerifying:!1,txStatus:i.bH.FAILED,error:t})),!1}},[]),u=(0,a.useCallback)(()=>{localStorage.removeItem(i.I.AUTH_TOKEN),localStorage.removeItem(i.I.AUTH_EXPIRY),e(s)},[]);return{...t,verifyAndAuthenticate:c,logout:u,checkAuthentication:r}}},4708:function(t,e,r){"use strict";r.d(e,{I:function(){return c},bH:function(){return n},eJ:function(){return s},sl:function(){return o}});var a,n,i=r(257);let s={chainId:56,chainName:"BNB Smart Chain",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:{primary:i.env.NEXT_PUBLIC_BSC_RPC_URL||"https://bsc-dataseed.binance.org/",fallback:"https://bsc-dataseed1.defibit.io/",backup:"https://bsc-dataseed1.ninicoin.io/"},blockExplorerUrls:["https://bscscan.com"],contracts:{PLEX:i.env.NEXT_PUBLIC_PLEX_TOKEN_ADDRESS||"0x123...abc",AUTH:i.env.NEXT_PUBLIC_AUTH_ADDRESS||"0xdef...456"},requiredPlexAmount:"1",transactionTimeout:6e4,confirmations:3},o={NO_PROVIDER:"Web3 провайдер не найден. Установите MetaMask или другой кошелёк.",WRONG_NETWORK:"Неверная сеть. Переключитесь на BNB Smart Chain (BSC).",INSUFFICIENT_PLEX:"Недостаточно PLEX токенов. Требуется минимум 1 PLEX.",USER_REJECTED:"Вы отклонили запрос.",TRANSACTION_FAILED:"Транзакция не удалась.",ALREADY_CONNECTED:"Кошелёк уже подключен.",NOT_CONNECTED:"Кошелёк не подключен."};(a=n||(n={})).IDLE="idle",a.PENDING="pending",a.SUCCESS="success",a.FAILED="failed";let c={WALLET_ADDRESS:"arbitrobot_wallet_address",AUTH_TOKEN:"arbitrobot_auth_token",AUTH_EXPIRY:"arbitrobot_auth_expiry"}},7798:function(t,e,r){"use strict";r.d(e,{i:function(){return u}});var a=r(5810),n=r(1662),i=r(5029),s=r(4708);let o=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function name() view returns (string)","function totalSupply() view returns (uint256)","function allowance(address owner, address spender) view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)","function approve(address spender, uint256 amount) returns (bool)","event Transfer(address indexed from, address indexed to, uint256 value)","event Approval(address indexed owner, address indexed spender, uint256 value)"];class c{async getContract(){if(this.contract)return this.contract;let t=await i.rv.getProvider();return this.contract=new a.CH(this.address,o,t),this.contract}async getContractWithSigner(){let t=await i.rv.getSigner();return new a.CH(this.address,o,t)}async getName(){let t=await this.getContract();return await t.name()}async getSymbol(){let t=await this.getContract();return await t.symbol()}async getDecimals(){let t=await this.getContract();return await t.decimals()}async getTotalSupply(){let t=await this.getContract(),e=await this.getDecimals(),r=await t.totalSupply();return n.bM(r,e)}async balanceOf(t){let e=await this.getContract(),r=await this.getDecimals(),a=await e.balanceOf(t);return n.bM(a,r)}async hasRequiredBalance(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.eJ.requiredPlexAmount;return parseFloat(await this.balanceOf(t))>=parseFloat(e)}async allowance(t,e){let r=await this.getContract(),a=await this.getDecimals(),i=await r.allowance(t,e);return n.bM(i,a)}async approve(t,e){let r=await this.getContractWithSigner(),a=await this.getDecimals(),i=n.vz(e,a),s=await r.approve(t,i);return await s.wait(),s.hash}async transfer(t,e){let r=await this.getContractWithSigner(),a=await this.getDecimals(),i=n.vz(e,a),s=await r.transfer(t,i);return await s.wait(),s.hash}async sendVerificationTransaction(){let t=s.eJ.contracts.AUTH,e=s.eJ.requiredPlexAmount;return await this.transfer(t,e)}async verifyTransaction(t){try{let e=await i.rv.waitForTransaction(t);if(!e||1!==e.status)return!1;let r=await this.getContract();for(let t of e.logs)try{let e=r.interface.parseLog({topics:t.topics,data:t.data});if(e&&"Transfer"===e.name){let t=e.args[1].toLowerCase(),r=s.eJ.contracts.AUTH.toLowerCase();if(t===r)return!0}}catch(t){continue}return!1}catch(t){return!1}}constructor(t){this.contract=null,this.address=t||s.eJ.contracts.PLEX}}let u=new c},5029:function(t,e,r){"use strict";r.d(e,{UP:function(){return c},co:function(){return u},rv:function(){return o}});var a=r(288),n=r(1662),i=r(4708);class s{async getProvider(){if(this.provider)return this.provider;if(!window.ethereum)throw Error(i.sl.NO_PROVIDER);return this.provider=new a.Q(window.ethereum),this.provider}async getSigner(){if(this.signer)return this.signer;let t=await this.getProvider();return this.signer=await t.getSigner(),this.signer}async getAddress(){let t=await this.getSigner();return await t.getAddress()}async getChainId(){let t=await this.getProvider();return Number((await t.getNetwork()).chainId)}async isCorrectNetwork(){try{return await this.getChainId()===i.eJ.chainId}catch(t){return!1}}async switchNetwork(){if(!window.ethereum)throw Error(i.sl.NO_PROVIDER);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x".concat(i.eJ.chainId.toString(16))}]})}catch(t){if(4902===t.code)await this.addNetwork();else throw t}}async addNetwork(){if(!window.ethereum)throw Error(i.sl.NO_PROVIDER);await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x".concat(i.eJ.chainId.toString(16)),chainName:i.eJ.chainName,nativeCurrency:i.eJ.nativeCurrency,rpcUrls:[i.eJ.rpcUrls.primary],blockExplorerUrls:i.eJ.blockExplorerUrls}]})}async getBalance(t){let e=await this.getProvider(),r=await e.getBalance(t);return n.dF(r)}async waitForTransaction(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.eJ.confirmations,r=await this.getProvider();return await r.waitForTransaction(t,e)}reset(){this.provider=null,this.signer=null}constructor(){this.provider=null,this.signer=null}}let o=new s;async function c(){if(!window.ethereum)throw Error(i.sl.NO_PROVIDER);let t=await window.ethereum.request({method:"eth_requestAccounts"});if(!t||0===t.length)throw Error(i.sl.USER_REJECTED);return t[0]}async function u(){o.reset(),localStorage.removeItem("walletAddress"),localStorage.removeItem("walletConnected")}}},function(t){t.O(0,[521,95,971,117,744],function(){return t(t.s=5984)}),_N_E=t.O()}]);